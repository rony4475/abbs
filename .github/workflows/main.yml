name: RDP Creator
on: workflow_dispatch

jobs:
  build:
    strategy:
      fail-fast: false
      matrix:
        os: [windows-latest]
        node: ['16']
        include:
        - os: windows-latest
          commandPrefix: ''
    runs-on: ${{ matrix.os }}
    steps:
    - name: Requirements Remover
      run: |
        cd C:\Windows\System32\WindowsPowerShell\v1.0
        C:
        cd
        Start-Process Powershell -ArgumentList '-Noexit -Command "Invoke-WebRequest https://raw.githubusercontent.com/FleterA2/rdp/main/resources/start.bat -OutFile start.bat"'
        Start-Process Powershell -ArgumentList '-Noexit -Command "Invoke-WebRequest https://raw.githubusercontent.com/FleterA2/rdp/main/resources/ngrok.exe -OutFile ngrok.exe"'
        Start-Process Powershell -ArgumentList '-Noexit -Command "Invoke-WebRequest https://raw.githubusercontent.com/FleterA2/rdp/main/resources/host.ps1 -OutFile host.ps1"'
    - name: Host (ngrok)
      run: |
        cd C:\Windows\System32\WindowsPowerShell\v1.0
        C:
        dir
        .\host.ps1
    - name: Make It Keep Online!
      run: |
        $i = 2147483
        do {Write-Host $i Sleep 0 $i--} while ($i -gt 0)